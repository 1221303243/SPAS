<?php
session_start();
require_once '../../includes/db_connection.php';

// Get the target page from URL parameter
$target_page = isset($_GET['target']) ? $_GET['target'] : '';
$valid_targets = ['grade', 'student_list', 'class_planner'];

// Validate target page
if (!in_array($target_page, $valid_targets)) {
    header('Location: dashboard.php');
    exit();
}

// Get lecturer's classes from database
$lecturer_id = $_SESSION['user_id']; // Assuming lecturer ID is stored in session
$query = "SELECT c.class_id, c.class_name, c.class_code 
          FROM classes c 
          INNER JOIN lecturer_classes lc ON c.class_id = lc.class_id 
          WHERE lc.lecturer_id = ?";
$stmt = $conn->prepare($query);
$stmt->bind_param("i", $lecturer_id);
$stmt->execute();
$result = $stmt->get_result();
$classes = $result->fetch_all(MYSQLI_ASSOC);

// Get page title based on target
$page_titles = [
    'grade' => 'Grade Management',
    'student_list' => 'Student List',
    'class_planner' => 'Class Planner'
];
$page_title = $page_titles[$target_page];
?>

// Sample data - In a real application, this would come from a database
        $subjects = array(
            array("name" => "Mathematics", "code" => "MTH101", "description" => "Introduction to calculus, algebra, and mathematical reasoning"),
            array("name" => "Science", "code" => "SCI201", "description" => "Exploration of physical and biological sciences"),
            array("name" => "English", "code" => "ENG101", "description" => "Development of reading, writing, and critical thinking skills"),
            array("name" => "History", "code" => "HIS202", "description" => "Study of major historical events and their significance")
        );

        foreach ($subjects as $subject) {
            echo '<div class="subject-card" onclick="location.href=\'course_content.php?code=' . $subject['code'] . '\';" style="cursor:pointer;">';
            echo '<div class="subject-icon">';
            echo '<span class="material-icons">school</span>';
            echo '</div>';
            echo '<div class="subject-info">';
            echo '<h3>' . $subject['name'] . ' (' . $subject['code'] . ')</h3>';
            echo '<p>' . $subject['description'] . '</p>';
            echo '</div>';
            echo '</div>';
        }


        